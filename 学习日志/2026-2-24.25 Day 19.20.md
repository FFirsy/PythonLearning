# Day 19: 2026-2-24
## OOP记账系统
    class Ledger:
    def __init__(self, filename="ledger.txt"):
        self.filename = filename
        self.transactions = []
        self.load()

    # ================= 数据层 =================
    def load(self):
        try:
            with open(self.filename, "r") as f:
                for line in f:
                    line = line.strip()
                    if line:
                        try:
                            self.transactions.append(float(line))
                        except ValueError:
                            continue
        except FileNotFoundError:
            pass

    def save(self):
        with open(self.filename, "w") as f:
            for amount in self.transactions:
                f.write(f"{amount}\n")

    # ================= 业务层 =================
    def add_income(self, amount):
        if amount <= 0:
            raise ValueError("Income must be positive.")
        self.transactions.append(amount)
        self.save()

    def add_expense(self, amount):
        if amount <= 0:
            raise ValueError("Expense must be positive.")
        self.transactions.append(-amount)
        self.save()

    def get_balance(self):
        return sum(self.transactions)

    # ================= 展示层 =================
    def show_menu(self):
        print("\n1. Add Income")
        print("2. Add Expense")
        print("3. Show Balance")
        print("4. Exit")

    def run(self):
        while True:
            self.show_menu()
            choice = input("Enter your choice: ").strip()

            if choice == "1":
                try:
                    amount = float(input("Income amount: "))
                    self.add_income(amount)
                    print(f"Current balance: {self.get_balance():.2f}")
                except ValueError as e:
                    print(e)

            elif choice == "2":
                try:
                    amount = float(input("Expense amount: "))
                    self.add_expense(amount)
                    print(f"Current balance: {self.get_balance():.2f}")
                except ValueError as e:
                    print(e)

            elif choice == "3":
                print(f"Current balance: {self.get_balance():.2f}")

            elif choice == "4":
                break
            else:
                print("Invalid choice.")

# Day 20: 2026-2-25
## OOP记账系统v2
数据结构升级  
存储方式改为 JSON  
支持时间戳和备注
    
    import json
    from datetime import datetime
    
    
    class Ledger:
        def __init__(self, filename="ledger.json"):
            self.filename = filename
            self.transactions = []
            self.load()
    
        # ================= 数据层 =================
        def load(self):
            try:
                with open(self.filename, "r", encoding="utf-8") as f:
                    self.transactions = json.load(f)
            except (FileNotFoundError, json.JSONDecodeError):
                self.transactions = []
    
        def save(self):
            with open(self.filename, "w", encoding="utf-8") as f:
                json.dump(self.transactions, f, indent=4, ensure_ascii=False)
    
        # ================= 业务层 =================
        def add_transaction(self, amount, t_type, note=""):
            if amount <= 0:
                raise ValueError("Amount must be positive.")
    
            record = {
                "amount": amount,
                "type": t_type,
                "timestamp": datetime.now().strftime("%Y-%m-%d %H:%M:%S"),
                "note": note
            }
    
            self.transactions.append(record)
            self.save()
    
        def get_balance(self):
            balance = 0
            for t in self.transactions:
                if t["type"] == "income":
                    balance += t["amount"]
                else:
                    balance -= t["amount"]
            return balance
    
        def get_total_income(self):
            return sum(t["amount"] for t in self.transactions if t["type"] == "income")
    
        def get_total_expense(self):
            return sum(t["amount"] for t in self.transactions if t["type"] == "expense")
    
        # ================= CLI 层 =================
        def show_menu(self):
            print("\n1. Add Income")
            print("2. Add Expense")
            print("3. Show Balance")
            print("4. Show Statistics")
            print("5. Exit")
    
        def run(self):
            while True:
                self.show_menu()
                choice = input("Choose: ").strip()
    
                if choice == "1":
                    try:
                        amount = float(input("Income amount: "))
                        note = input("Note: ")
                        self.add_transaction(amount, "income", note)
                        print("Income added.")
                    except ValueError as e:
                        print(e)
    
                elif choice == "2":
                    try:
                        amount = float(input("Expense amount: "))
                        note = input("Note: ")
                        self.add_transaction(amount, "expense", note)
                        print("Expense added.")
                    except ValueError as e:
                        print(e)
    
                elif choice == "3":
                    print(f"Balance: {self.get_balance():.2f}")
    
                elif choice == "4":
                    print(f"Total income: {self.get_total_income():.2f}")
                    print(f"Total expense: {self.get_total_expense():.2f}")
    
                elif choice == "5":
                    break
                else:
                    print("Invalid choice.")


    if __name__ == "__main__":
        app = Ledger()
        app.run()